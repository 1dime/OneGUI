        -:    0:Source:mutant_ds_harness.cpp
        -:    0:Graph:mutant_ds_harness.gcno
        -:    0:Data:mutant_ds_harness.gcda
        -:    0:Runs:4
        -:    0:Programs:1
        -:    1:#include <deepstate/DeepState.hpp>
        -:    2:#include <cstring>
        -:    3:#include <string>
        -:    4:#include <properties/property.hpp>
        -:    5:#include <widgets/widget.hpp>
        -:    6:#include <iostream>
        -:    7:
        -:    8:using namespace deepstate;
        -:    9:
        -:   10:void testDictItem();
        -:   11:void testListItem();
        -:   12:void testList();
        -:   13:void testJson();
        -:   14:void testProperty();
        -:   15:void testWidget();
        -:   16:
function __cxx_global_var_init.5 called 4 returned 100% blocks executed 100%
function _ZN32DeepState_Register_Main_Basic_t_C2Ev called 4 returned 100% blocks executed 100%
function _ZL29DeepState_Register_Main_Basicv called 4 returned 100% blocks executed 100%
function _ZL24DeepState_Run_Main_Basicv called 2 returned 0% blocks executed 50%
function _ZL25DeepState_Test_Main_Basicv called 2 returned 100% blocks executed 100%
       16:   17:TEST(Main, Basic)
        -:   18:{
        -:   19:    //Test the dict item class
        2:   20:    testDictItem();
        -:   21:
        -:   22:    //And test the list item class
        2:   23:    testListItem();
        -:   24:
        -:   25:    //Now test the list class
        2:   26:    testList();
        -:   27:
        -:   28:    //And test the JSON class (by nlohmann)
        2:   29:    testJson();
        -:   30:
        -:   31:    //Then test the property class
        2:   32:    testProperty();
        -:   33:
        -:   34:    //And the widget class
        2:   35:    testWidget();
        2:   36:}
        -:   37:
        -:   38://Creates a new string using deepstate
function _Z12makeDSStringm called 32 returned 100% blocks executed 100%
       32:   39:char *makeDSString(size_t size)
        -:   40:{
       32:   41:  char *str = (char *) DeepState_Malloc(size);
      160:   42:  for(int index = 0; index < size; index++)
branch  0 taken 20%
branch  1 taken 80%
        -:   43:  {
      128:   44:    str[index] = DeepState_Char();
        -:   45:  }
        -:   46:  
        -:   47:  //Return the string
       32:   48:  return str;
        -:   49:}
        -:   50:
        -:   51://Tests the DictItem structure
function _Z12testDictItemv called 2 returned 100% blocks executed 46%
        2:   52:void testDictItem()
        -:   53:{
        -:   54:    //Create a new DictItem
        2:   55:    char *key = makeDSString(4);
        2:   56:    char *valueChars = makeDSString(4);
        -:   57:    
        2:   58:    std::string *value = new std::string(valueChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:   59:    DictItem *item = new DictItem(key, static_cast<void *>(value));
branch  0 taken 100%
branch  1 taken 0%
        -:   60:
        -:   61:    //And test if the key and value match
        2:   62:    ASSERT((std::strcmp(key, item->k.c_str())) == 0) << "DictItem: key does not match stored.";
branch  0 taken 100%
branch  1 taken 0%
        2:   63:    ASSERT((std::strcmp(value->c_str(), (static_cast<std::string *>(item->v))->c_str())) == 0) << "DictItem: value does not match stored.";
branch  0 taken 100%
branch  1 taken 0%
        2:   64:}
        -:   65:
        -:   66://Tests ListItem structure
function _Z12testListItemv called 2 returned 100% blocks executed 40%
        2:   67:void testListItem()
        -:   68:{
        -:   69:    //Create two new list items
        2:   70:    char *firstListDataChars = makeDSString(4);
        2:   71:    char *secondListDataChars = makeDSString(4);
        2:   72:    std::string *firstListData = new std::string(firstListDataChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:   73:    std::string *secondListData = new std::string(secondListDataChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:   74:    ListItem *firstItem = new ListItem(static_cast<void *>(firstListData));
branch  0 taken 100%
branch  1 taken 0%
        2:   75:    ListItem *secondItem = new ListItem(static_cast<void *>(secondListData));
branch  0 taken 100%
branch  1 taken 0%
        -:   76:
        -:   77:    //Add second item to first
        2:   78:    firstItem->next = secondItem;
        -:   79:
        -:   80:    //Now test if the second item was added
        2:   81:    ASSERT(firstItem->next == secondItem) << "ListItem: failed to add second list item to first.";
branch  0 taken 100%
branch  1 taken 0%
        -:   82:    //And test the first item's parameters
        2:   83:    ASSERT(std::strcmp(firstListData->c_str(), (static_cast<std::string *>(firstItem->getData())->c_str())) == 0) << "ListItem: First Item: data is not the same";
branch  0 taken 100%
branch  1 taken 0%
        -:   84:    //And the second item's parameters
        2:   85:    ASSERT(std::strcmp(secondListData->c_str(), (static_cast<std::string *>(secondItem->getData())->c_str())) == 0) << "ListItem: Second Item: data is not the same";
branch  0 taken 100%
branch  1 taken 0%
        2:   86:}
        -:   87:
        -:   88://Checks if a list was added
function _Z9listAddedP4ListS0_ called 2 returned 100% blocks executed 100%
        2:   89:bool listAdded(List *head, List *list)
        -:   90:{
        -:   91:    //Get items from both lists
        2:   92:    ListItem *headItem = (ListItem *) head->getItem();
        2:   93:    ListItem *listItem = (ListItem *) list->getItem();
        -:   94:
        -:   95:    //And return if they are equal
        6:   96:    return std::strcmp((static_cast<std::string *>(headItem->getData()))->c_str(),
        4:   97:                    (static_cast<std::string *>(listItem->getData()))->c_str()) == 0;
        -:   98:}
        -:   99:
        -:  100://Tests List class
function _Z8testListv called 2 returned 100% blocks executed 43%
        2:  101:void testList()
        -:  102:{
        -:  103:    //Create the parameters for two lists
        2:  104:    char *firstListData = makeDSString(4);
        2:  105:    char *secondListData = makeDSString(4);
        2:  106:    std::string *firstListString = new std::string(firstListData);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:  107:    std::string *secondListString = new std::string(secondListData);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        -:  108:
        -:  109:    //And create two lists
        2:  110:    List *firstList = new List(new ListItem(static_cast<void *>(firstListString)));
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
        2:  111:    List *secondList = new List(new ListItem(static_cast<void *>(secondListString)));
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
        -:  112:
        -:  113:    //Now add second list to first
        2:  114:    firstList->addItem(secondList->getItem());
        -:  115:
        -:  116:    //And test if the second list was added
        2:  117:    ASSERT(listAdded(firstList, secondList)) << "List: failed to add second list to first.";
branch  0 taken 100%
branch  1 taken 0%
        2:  118:    firstList->setItem(firstList->getItem()->previous);
        -:  119:
        -:  120:    //Then test first list's parameters
        2:  121:    ASSERT((std::strcmp(firstListString->c_str(), (static_cast<std::string *>(firstList->getItem()->getData()))->c_str())) == 0) << "List: First List: data is not the same.";
branch  0 taken 100%
branch  1 taken 0%
        -:  122:
        -:  123:    //And test second list's parameters
        2:  124:    ASSERT((std::strcmp(secondListString->c_str(), (static_cast<std::string *>(secondList->getItem()->getData()))->c_str())) == 0) << "List: Second List: data is not the same";
branch  0 taken 100%
branch  1 taken 0%
        2:  125:}
        -:  126:
        -:  127://Tests nlohmann's JSON
function _Z8testJsonv called 2 returned 100% blocks executed 50%
        2:  128:void testJson()
        -:  129:{
        -:  130:    //Create a simple key and value for json
        2:  131:    char *key = makeDSString(4);
        2:  132:    char *value = makeDSString(4);
        -:  133:
        -:  134:    //And add them to new json element
        2:  135:    nlohmann::json data;
        2:  136:    data[key] = value;
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
        -:  137:
        -:  138:    //Now test the data
        2:  139:    ASSERT(data.contains(key) == true) << "Json: key does not match";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
        2:  140:    ASSERT(std::strcmp(value, data[key].get<std::string>().c_str()) == 0) << "Json: value does not match";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
branch  6 taken 100%
branch  7 taken 0%
        2:  141:}
        -:  142:
        -:  143://Tests the Property class
function _Z12testPropertyv called 2 returned 100% blocks executed 44%
        2:  144:void testProperty()
        -:  145:{
        -:  146:    //Create a basic property
        2:  147:    char *key = makeDSString(4);
        2:  148:    char *valueChars = makeDSString(4);
        2:  149:    std::string *value = new std::string(valueChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:  150:    Property *property = new Property();
branch  0 taken 100%
branch  1 taken 0%
        2:  151:    property->addItem(new DictItem(key, static_cast<void *>(value)));
branch  0 taken 100%
branch  1 taken 0%
        -:  152:
        -:  153:    //Make sure property key and value match
        2:  154:    ASSERT(std::strcmp(key, property->key()) == 0) << "Property: Key does not match";
branch  0 taken 100%
branch  1 taken 0%
        2:  155:    ASSERT(std::strcmp(value->c_str(), property->valueAsString().c_str()) == 0) << "Property: Value does not match";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
        2:  156:}
        -:  157:
        -:  158://Returns if a widget was added to a widget list
function _Z11widgetAddedP6WidgetS0_ called 2 returned 100% blocks executed 72%
        2:  159:bool widgetAdded(Widget *head, Widget *widget)
        -:  160:{
        2:  161:    WidgetItem *headItems = (WidgetItem *) ((ListItem *) head->getItem())->getData();
        2:  162:    WidgetItem *widgetItems = (WidgetItem *) ((ListItem *) widget->getItem())->getData();
        4:  163:    return ((headItems->x == widgetItems->x)
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
branch  4 taken 100%
branch  5 taken 0%
branch  6 taken 100%
branch  7 taken 0%
branch  8 never executed
branch  9 never executed
branch 10 never executed
branch 11 never executed
branch 12 never executed
branch 13 never executed
        2:  164:        && (headItems->y == widgetItems->y)
branch  0 taken 100%
branch  1 taken 0%
        2:  165:        && (headItems->width == widgetItems->width)
branch  0 taken 100%
branch  1 taken 0%
        2:  166:        && (headItems->height == widgetItems->height)
branch  0 taken 100%
branch  1 taken 0%
        2:  167:        && (std::strcmp(((std::string *) headItems->widgetData)->c_str(), ((std::string *) widgetItems->widgetData)->c_str()) == 0)
branch  0 taken 100%
branch  1 taken 0%
        2:  168:        && (std::strcmp(headItems->properties->key(), widgetItems->properties->key()) == 0)
branch  0 taken 100%
branch  1 taken 0%
        2:  169:        && (std::strcmp(headItems->properties->valueAsString().c_str(), widgetItems->properties->valueAsString().c_str()) == 0));
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
        2:  170:}
        -:  171:
        -:  172://Tests widget structure
function _Z10testWidgetv called 2 returned 100% blocks executed 40%
        2:  173:void testWidget()
        -:  174:{
        -:  175:    //Create parameters for two widgets
        2:  176:    char *firstDataChars = makeDSString(4);
        2:  177:    char *secondDataChars = makeDSString(4);
        2:  178:    char *firstPropChars = makeDSString(4);
        2:  179:    char *secondPropChars = makeDSString(4);
        2:  180:    int firstX = DeepState_Int();
        2:  181:    int secondX = DeepState_Int();
        2:  182:    int firstY = DeepState_Int();
        2:  183:    int secondY = DeepState_Int();
        2:  184:    int firstWidth = DeepState_Int();
        2:  185:    int secondWidth = DeepState_Int();
        2:  186:    int firstHeight = DeepState_Int();
        2:  187:    int secondHeight = DeepState_Int();
        -:  188:    
        2:  189:    std::string *firstWidgetData = new std::string(firstDataChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:  190:    std::string *secondWidgetData = new std::string(secondDataChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        -:  191:    
        2:  192:    char *firstPropKey = (char *) makeDSString(4);
        2:  193:    char *secondPropKey = (char *) makeDSString(4);
        -:  194:    
        2:  195:    std::string *firstPropVal = new std::string(firstPropChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:  196:    std::string *secondPropVal = new std::string(secondPropChars);
branch  0 taken 100%
branch  1 taken 0%
branch  2 never executed
branch  3 never executed
        2:  197:    Property *firstProperty = new Property();
branch  0 taken 100%
branch  1 taken 0%
        2:  198:    firstProperty->addItem(new DictItem(firstPropKey, static_cast<void *>(firstPropVal)));
branch  0 taken 100%
branch  1 taken 0%
        2:  199:    Property *secondProperty = new Property();
branch  0 taken 100%
branch  1 taken 0%
        2:  200:    secondProperty->addItem(new DictItem(secondPropKey, static_cast<void *>(secondPropVal)));
branch  0 taken 100%
branch  1 taken 0%
        -:  201:
        -:  202:    //And create the two widgets
        2:  203:    Widget *firstWidget = new Widget(firstX, firstY, firstWidth, firstHeight, static_cast<void *>(firstWidgetData), firstProperty);
branch  0 taken 100%
branch  1 taken 0%
        2:  204:    Widget *secondWidget = new Widget(secondX, secondY, secondWidth, secondHeight, static_cast<void *>(secondWidgetData), secondProperty);
branch  0 taken 100%
branch  1 taken 0%
        -:  205:
        -:  206:    //Now add the second widget to the first
        2:  207:    firstWidget->addItem(secondWidget->getItem());
        -:  208:
        -:  209:    //Test that the second widget was added successfully
        2:  210:    ASSERT(widgetAdded(firstWidget, secondWidget)) << "Widget: Failed to add second widget to first.";
branch  0 taken 100%
branch  1 taken 0%
        2:  211:    firstWidget->setItem(firstWidget->getItem()->previous);
        -:  212:
        -:  213:    //Now test the first widget's properties
        2:  214:    WidgetItem *firstWidgetParams = (WidgetItem *) ((ListItem *) firstWidget->getItem())->getData();
        2:  215:    ASSERT(firstX == firstWidgetParams->x) << "Widget: First Widget: x is not the same value.";
branch  0 taken 100%
branch  1 taken 0%
        2:  216:    ASSERT(firstY == firstWidgetParams->y) << "Widget: First Widget: y is not the same value.";
branch  0 taken 100%
branch  1 taken 0%
        2:  217:    ASSERT(firstWidth == firstWidgetParams->width) << "Widget: First Widget: width is not the same.";
branch  0 taken 100%
branch  1 taken 0%
        2:  218:    ASSERT(firstHeight == firstWidgetParams->height) << "Widget: First Widget: height is not the same value.";
branch  0 taken 100%
branch  1 taken 0%
        2:  219:    ASSERT(std::strcmp(firstWidgetData->c_str(), (static_cast<std::string *>(firstWidgetParams->widgetData))->c_str()) == 0) << "Widget: First Widget: data is not the same";
branch  0 taken 100%
branch  1 taken 0%
        2:  220:    ASSERT((std::strcmp(firstPropKey, firstWidgetParams->properties->key()) <= 0)) << "Widget: First Widget: Property: key is not the same";
branch  0 taken 100%
branch  1 taken 0%
        2:  221:    ASSERT((std::strcmp(firstPropVal->c_str(), firstWidgetParams->properties->valueAsString().c_str()) == 0)) << "Widget: First Widget: Property: value is not the same";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
        -:  222:
        -:  223:    //And test the second widget's properties
        2:  224:    WidgetItem *secondWidgetParams = (WidgetItem *) ((ListItem *) secondWidget->getItem())->getData();
        2:  225:    ASSERT(secondX == secondWidgetParams->x) << "Widget: Second Widget: x is not the same value.";
branch  0 taken 100%
branch  1 taken 0%
        2:  226:    ASSERT(secondY == secondWidgetParams->y) << "Widget: Second Widget: y is not the same value.";
branch  0 taken 100%
branch  1 taken 0%
        2:  227:    ASSERT(secondWidth == secondWidgetParams->width) << "Widget: Second Widget: width is not the same.";
branch  0 taken 100%
branch  1 taken 0%
        2:  228:    ASSERT(secondHeight == secondWidgetParams->height) << "Widget: Second Widget: height is not the same value.";
branch  0 taken 100%
branch  1 taken 0%
        2:  229:    ASSERT(std::strcmp(secondWidgetData->c_str(), (static_cast<std::string *>(secondWidgetParams->widgetData))->c_str()) == 0) << "Widget: Second Widget: data is not the same";
branch  0 taken 100%
branch  1 taken 0%
        2:  230:    ASSERT((std::strcmp(secondPropKey, secondWidgetParams->properties->key()) == 0)) << "Widget: Second Widget: Property: key is not the same";
branch  0 taken 100%
branch  1 taken 0%
        2:  231:    ASSERT((std::strcmp(secondPropVal->c_str(), secondWidgetParams->properties->valueAsString().c_str()) == 0)) << "Widget: Second Widget: Property: value is not the same";
branch  0 taken 100%
branch  1 taken 0%
branch  2 taken 100%
branch  3 taken 0%
        2:  232:}
